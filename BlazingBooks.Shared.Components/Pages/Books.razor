@page "/"
@page "/page/{pageNo:int?}"
@inject IBookService BookService;

<PageTitle>Home | Blazing Books</PageTitle>

<SectionContent SectionName="PageTitle">
    <h1 class="m-0 text-white fw-bold">Blazing Books</h1>
    <h3 class="text-white mt-2">A library of hundreds of popular books</h3>
</SectionContent>

<div class="container-lg">
    <h4>Books listing will go here</h4>
</div>

@code {

    [Parameter]
    public int? PageNo { get; set; } = 1;

    private GenreDto[] _genres = [];
    private BookListDto[] _books = [];
    private BookListDto[] _popularBooks = [];
    private int _totalCount = 0;

    private const int PageSize = 16;


    protected override async Task OnInitializedAsync()
    {
        var genreTask = BookService.GetGenresAsync(topOnly: true);
        var booksTask = BookService.GetBooksAsync(PageNo ?? 1, PageSize);
        var popularTask = BookService.GetPopularBooksAsync(10);


        _genres = await genreTask;
        (_books, _totalCount) = await booksTask;
        _popularBooks = await popularTask;
    }
}
